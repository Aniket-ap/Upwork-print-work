<html>

<head>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/somethinggoodone/cdn/AniketPradhan_bootstrap.css" />
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>
	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
	<style>
	input,
	select,
	textarea {
		text-overflow: ellipsis;
	}

	button:focus,
	button:active {
		outline-color: #c6a5ff;
	}
	label {
		font-weight: 500 !important;
		color: #374151 !important;
	}

	.bg-theme {
		background: rgba(103, 58, 183, .07) !important;
	}

	.text-theme {
		color: #673ab7;
	}
	</style>
</head>

<body>
	<button type="button" class="m-3 btn btn-primary" id="pdfprint">New PDF File</button>
	<button type="button" class="m-3 btn btn-outline-secondary" id="restoreall">Restore All</button>
	<button type="button" class="m-3 btn btn-outline-secondary" id="sendall">Send All</button>
	<hr>
	<ul class="list-group" id="tasks-point-l9zgqjql"></ul>
	<div id="modal"></div>
	<script>
	function atoo(f, b) {
		var c = [],
			d = !1;
		f.forEach(function(g, e) {
			var a = {};
			a.key = g;
			a.value = 0 === b[e].length ? "" : b[e];
			"" === a.key.trim() && "" !== a.value ? d = !0 : "" !== a.key.trim() && c.push(a);
		});
		return d ? !1 : c;
	}

	function getAddTaskEnvelope(wid, tid, tasktype, task_body) {
		return `<li class="border-top-0 border-end-0 border-start-0 list-group-item tsk-${wid}-${tid} ${tasktype}" data-id="${wid}-${tid}" data-type="${tasktype}">
			<img src="https://img.icons8.com/color/48/null/pdf.png" class="float-start" />
			<div class="btn-group float-end">
				<button type="button" class="btn dropdown-toggle btn-light" data-bs-toggle="dropdown" aria-expanded="false"> Actions </button>
				<ul class="dropdown-menu dropdown-menu-lg-end">
					<li><a data-bs-toggle="modal" href="#task-modal-${wid}-${tid}" role="button" class="dropdown-item" href="#">Edit</a></li>
					<li><a class="dropdown-item" href="#">Duplicate</a></li>
					<li><a class="dropdown-item tdelete" href="#">Delete</a></li>
				</ul>
			</div>
			${task_body}
		</li>`
	}

	function getPDFFileValues(wid, tid) {
		let result = {};
		result.taskType = "pdfprint";
		result.id = tid;
		result.name = `${wid}-${tid}`;
		// Page setup
		// Print
		let printValue = $(`#print-${wid}-${tid}`).val();
		let printTextValue = $(`#print-${wid}-${tid} option:selected`).text();
		if(printTextValue.indexOf("Selected range of ") == 0){
			let rangeVal = $(`#print-range-${wid}-${tid}`).val();
			if(rangeVal.trim().length === 0){
				alert("Range should not be empty in Page setup tab");
				return;
			}
			result.print = {
				"type" : "custom",
				"value": {
					"range": `${rangeVal}`
				}
			}
		} else{
			result.print = {
				"type" : `${printValue}`
			}
		}
		// Paper Size
		let paperSizeVal = $(`#size-${wid}-${tid}`).val();
		if(paperSizeVal == "custom"){
			let height = $(`#size-height-${wid}-${tid}`).val();
			let width = $(`#size-width-${wid}-${tid}`).val();
			if(height.trim().length === 0 || width.trim().length === 0){
				alert("Height and Width should not be empty in Page setup tab");
				return;
			}
			if(Number(height) > 2.4 && Number(height) <= 60){
				alert("Please enter height number in between 2.4 to 60");
				return;
			}
			if(Number(width) > 2.5 && Number(width) <= 60){
				alert("Please enter width number in between 2.5 to 60");
				return;
			}
			result.size = {
				"type" : "custom",
				"value" : {
					"height" : `${height}`,
					"width" : `${width}`,
				}
			}
		} else{
			result.size = {
				"type" : `${paperSizeVal}`
			}
		}
		// Scale
		let scaleVal = $(`#scale-${wid}-${tid}`).val();
		if(scaleVal == "custom"){
			let percentageVal = $(`#percentage-${wid}-${tid}`).val();
			if(percentageVal.trim().length === 0){
				alert("Percentage should not be empty in Page setup tab");
				return;
			}
			if(Number(percentageVal) < 1){
				alert("Please enter a positive percentage number ");
				return;
			}
			result.scale = {
				"type" : "custom",
				"value" : {
					"percentage" : `${percentageVal}`,
				}
			}
		} else if(scaleVal == "fittipagebreaks"){
			let row = $(`#break-row-${wid}-${tid}`).val();
			let col = $(`#break-column-${wid}-${tid}`).val();
			if(row.trim().length === 0 || col.trim().length === 0){
				alert("Row and Column value should not be empty in Page setup tab");
				return;
			}
			result.scale = {
				"type" : "fit_pagebreak",
				"value" : {
					"row" : `${row}`,
					"column" : `${col}`
				}
			}
		} else{
			result.scale = {
				"type" : `${scaleVal}`
			}
		}
		// Margins
		let marginsVal = $(`#margins-${wid}-${tid}`).val();
		if(marginsVal == "custom"){
			let top = $(`#margins-top-${wid}-${tid}`).val();
			let left = $(`#margins-left-${wid}-${tid}`).val();
			let right = $(`#margins-right-${wid}-${tid}`).val();
			let bottom = $(`#margins-bottom-${wid}-${tid}`).val();
			if(top.trim().length === 0 || left.trim().length === 0 || right.trim().length === 0 || bottom.trim().length === 0){
				alert("Top, Left, Right and Bottom value should not be empty in Page setup tab");
				return;
			}
			if(Number(top) <= 0 || Number(top) >= 0.3){
				alert("Please enter top value in inches between 0 to 0.3 ");
				return;
			}
			if(Number(right) <= 0 || Number(top) >= 1.5){
				alert("Please enter right value in inches between 0 to 1.5 ");
				return;
			}
			if(Number(bottom) <= 0 || Number(bottom) >= 0.3){
				alert("Please enter bottom value in inches between 0 to 0.3 ");
				return;
			}
			if(Number(left) <= 0 || Number(left) >= 0.75){
				alert("Please enter left value in inches between 0 to 0.75 ");
				return;
			}
			result.margins = {
				"type" : "custom",
				"value" : {
					"top" : `${top}`,
					"left" : `${left}`,
					"right" : `${right}`,
					"bottom" : `${bottom}`,
				}
			}
		} else{
			result.margins = {
				"type" : `${marginsVal}`
			}
		}
		// Page Orietation
		let selectedRadioValue = $("input[name='pageSetupRadio']:checked").val();
		result.orientation = {
			"type": `${selectedRadioValue}`
		}
		// Format tab
		// gridlines
		if($(`#showgridlines-${wid}-${tid}`).is(":checked")){
			result.gridlines = {
				"value" : "true"
			}
		} else{
			result.gridlines = {
				"value" : "false"
			}
		}
		// notes
		if($(`#shownotes-${wid}-${tid}`).is(":checked")){
			result.notes = {
				"value" : "true"
			}
		} else{
			result.notes = {
				"value" : "false"
			}
		}
		// Pageorder
		let pageOrderVal = $(`#pageorder-${wid}-${tid}`).val();
		result.pageorder = {
			"value" : `${pageOrderVal}`
		}
		// Alignment
		let h_val = $(`#horizontal-alignment-${wid}-${tid}`).val();
		result.h_alignment = {
			"value" : `${h_val}`
		}
		let v_val = $(`#vertical-alignment-${wid}-${tid}`).val();
		result.v_alignment = {
			"value" : `${v_val}`
		}
		// Headers & Footer
		if($(`#frozen-rows-${wid}-${tid}`).is(":checked")){
			result.fzr_hf = {
				"options" : {
					"hf_fzr" : "true",
					"hf_fzc" : "false"
				}
			}
		} else{
			result.fzr_hf = {
				"options" : {
					"hf_fzr" : "false",
					"hf_fzc" : "false"
				}
			}
		}
		if($(`#frozen-columns-${wid}-${tid}`).is(":checked")){
			result.fzc_hf = {
				"options" : {
					"hf_fzr" : "false",
					"hf_fzc" : "true"
				}
			}
		} else{
			result.fzc_hf = {
				"options" : {
					"hf_fzr" : "false",
					"hf_fzc" : "false"
				}
			}
		}

		// Response
		result.response = [];
		console.log(result)
		return result;

	}

	function createTask_PDFFile(wid, task) {
		var tid = task?.id ? task.id : Math.random().toString(36).substr(2, 8);
		var html_task = getAddTaskEnvelope(wid, tid, "pdfprint", `<div class="ms-5 ps-3">
	<span class="task-title">PDF File: ${wid}-${tid} </span><br>
	<span class="text-secondary small">Last updated </span><span class="time text-secondary small" data-time="1667889127596">15 days ago</span>
</div>
<div class="modal fade" id="task-modal-${wid}-${tid}" aria-hidden="true" aria-labelledby="task-modal-label-${wid}-${tid}" tabindex="-1">
	<div class="modal-dialog modal-fullscreen">
		<div class="modal-content">
			<div class="modal-header border border-bottom-0 bg-theme">
				<img style="width:25px;" src="https://img.icons8.com/color/48/null/pdf.png" class="float-start">&nbsp;
				<span class="modal-title fw-bolder ms-1 ps-0" id="task-modal-label-${wid}-${tid}">Create PDF File Instance</span>
				<button type="button" class="me-1 btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div class="modal-body border">
				<!--Modal body goes here.-->
				<div class="container mt-5">
					<!-- TAB -->
					<nav class="mt-5">
						<div class="nav nav-tabs" role="tablist">
							<button type="button" class="nav-link active" data-bs-toggle="tab" data-bs-target="#nav-page-setup" role="tab" aria-selected="true"> Page Setup <span class="ms-1 d-inline-block rounded-circle"></span>
							</button>
							<button type="button" class="nav-link" data-bs-toggle="tab" data-bs-target="#nav-formating" role="tab" aria-selected="false"> Formatting </button>
							<button type="button" class="nav-link" data-bs-toggle="tab" data-bs-target="#nav-headers-footers" role="tab" aria-selected="false"> Headers & Footers <span class="ms-1 d-inline-block rounded-circle"></span>
							</button>
						</div>
					</nav>
					<!-- TAB CONTENT -->
					<div class="tab-content mt-3">
						<!-- page setup Content -->
						<div class="tab-pane show active" id="nav-page-setup" role="tabpanel">
							<table border="0" style="width:100%">
								<tr>
									<td class="p-3">
										<label for="print-${wid}-${tid}" class="form-label">Print</label>
										<div class="input-group">
											<select class="form-select" id="print-${wid}-${tid}">
												<option selected value="workbook">Workbook</option>
											</select>
											<span class="input-group-text bg-theme range-span">Range</span>
											<input type="text" class="form-control" id="print-range-${wid}-${tid}" aria-label="Range input">
										</div>
									</td>
								</tr>
								<tr>
									<td class="p-3">
										<label for="size-${wid}-${tid}" class="form-label">Paper size</label>
										<div class="input-group">
											<select class="form-select" id="size-${wid}-${tid}">
												<option data-width="8.5" data-height="11" selected="" value="letter">Letter (8.5" x 11")</option>
												<option data-width="11" data-height="17" value="tabloid">Tabloid (11" x 17")</option>
												<option data-width="8.5" data-height="14" value="legal">Legal (8.5" x 14")</option>
												<option data-width="5.5" data-height="8.5" value="statement">Statement (5.5" x 8.5")</option>
												<option data-width="7.25" data-height="10.5" value="executive">Executive (7.25" x 10.5")</option>
												<option data-width="8.5" data-height="13" value="folio">Folio (8.5" x 13")</option>
												<option data-width="11.69" data-height="16.54" value="a3">A3 (11.69" x 16.54")</option>
												<option data-width="8.27" data-height="11.69" value="a4">A4 (8.27" x 11.69")</option>
												<option data-width="5.83" data-height="8.27" value="a5">A5 (5.83" x 8.27")</option>
												<option data-width="9.84" data-height="13.90" value="b4">B4 (9.84" x 13.90")</option>
												<option data-width="6.93" data-height="9.84" value="b5">B5 (6.93" x 9.84")</option>
												<option data-width="" data-height="" value="custom">Custom</option>
											</select>
											<span class="input-group-text bg-theme">Width ″</span>
											<input type="number" class="form-control" id="size-width-${wid}-${tid}" value="8.5" step="0.5">
											<span class="input-group-text bg-theme">Height ″</span>
											<input type="number" class="form-control" id="size-height-${wid}-${tid}" value="11" step="0.5">
										</div>
									</td>
								</tr>
								<tr>
									<td class="p-3">
										<label for="margins-${wid}-${tid}" class="form-label">Margins</label>
										<div class="input-group">
											<select class="form-select" id="margins-${wid}-${tid}">
												<option data-top="0.70" data-left="0.70" data-right="0.70" data-bottom="0.70" value="currentsheet" selected="">Normal</option>
												<option data-top="0.25" data-left="0.25" data-right="0.25" data-bottom="0.25" value="workbook">Narrow</option>
												<option data-top="1" data-left="1" data-right="1" data-bottom="1" value="selectedcells">Wide</option>
												<option data-top="" data-left="" data-right="" data-bottom="" value="custom">Custom</option>
											</select>
											<span class="input-group-text bg-theme">Top ″</span>
											<input type="number" class="form-control" value="0.1" id="margins-top-${wid}-${tid}">
											<span class="input-group-text bg-theme">Left ″</span>
											<input type="number" class="form-control" value="1.1" id="margins-left-${wid}-${tid}">
											<span class="input-group-text bg-theme">Right ″</span>
											<input type="number" class="form-control" value="2.2" id="margins-right-${wid}-${tid}">
											<span class="input-group-text bg-theme">Bottom ″</span>
											<input type="number" class="form-control" value="3.3" id="margins-bottom-${wid}-${tid}">
										</div>
									</td>
								</tr>
								<tr>
									<td class="p-3">
										<label for="scale-${wid}-${tid}" class="form-label">Scale</label>
										<div class="input-group">
											<select class="form-select" id="scale-${wid}-${tid}">
												<option selected value="normal">Normal (100%)</option>
												<option value="fittowidth">Fit to width</option>
												<option value="fittoheight">Fit to height</option>
												<option value="fittopage">Fit to page</option>
												<option value="custom">Custom</option>
												<option value="fittipagebreaks">Fit to pagebreaks (100%)</option>
											</select>
											<span class="input-group-text bg-theme custom-span">%</span>
											<input type="number" class="form-control" value="88" step="1" id="percentage-${wid}-${tid}">
											<span class="input-group-text bg-theme break-span">Break row at</span>
											<input type="number" class="form-control" value="20" id="break-row-${wid}-${tid}">
											<span class="input-group-text bg-theme break-span">Break column at</span>
											<input type="number" class="form-control" value="5" id="break-column-${wid}-${tid}">
										</div>
									</td>
								</tr>
								<tr>
									<td class="p-3">
										<label class="form-label d-block mb-3">Page Orientation</label>
										<div class="form-check form-check-inline">
											<input class="form-check-input" type="radio" name="pageSetupRadio" id="landscape-${wid}-${tid}" value="landscape">
											<label class="form-check-label" for="landscape-${wid}-${tid}">Landscape</label>
										</div>
										<div class="form-check form-check-inline">
											<input class="form-check-input" type="radio" name="pageSetupRadio" id="portait-${wid}-${tid}" value="protait" checked>
											<label class="form-check-label" for="portait-${wid}-${tid}">Portait</label>
										</div>
									</td>
								</tr>
							</table>
						</div>
						<!-- Formating Content -->
						<div class="tab-pane" id="nav-formating" role="tabpanel">
							<table border="0" style="width:100%">
								<tr>
									<td class="p-3">
										<label for="pageorder-${wid}-${tid}" class="form-label">Page order</label>
										<select class="form-select" id="pageorder-${wid}-${tid}">
											<option selected value="over_then_down">Over, then down</option>
											<option value="down_then_over">Down, then over</option>
										</select>
									</td>
									<td class="p-3">
										<label for="horizontal-alignment-${wid}-${tid}" class="form-label">Horizontal Alignment</label>
										<select class="form-select" id="horizontal-alignment-${wid}-${tid}">
											<option selected value="horizontal_center">Center</option>
											<option value="horizontal_left">Left</option>
											<option value="horizontal_right">Right</option>
										</select>
									</td>
								</tr>
								<tr>
									<td class="p-3">
										<div class="d-flex flex-column justify-content-end">
											<div class="form-check">
												<input class="form-check-input" type="checkbox" id="showgridlines-${wid}-${tid}">
												<label class="form-check-label" for="showgridlines-${wid}-${tid}">
													Show gridlines
												</label>
											</div>
											<div class="form-check">
												<input class="form-check-input" type="checkbox" id="shownotes-${wid}-${tid}">
												<label class="form-check-label" for="shownotes-${wid}-${tid}">
													Show notes
												</label>
											</div>
										</div>
									</td>
									<td class="p-3">
										<label for="vertical-alignment-${wid}-${tid}" class="form-label">Vertical Alignment</label>
										<select class="form-select" id="vertical-alignment-${wid}-${tid}">
											<option selected value="vertical_top">Top</option>
											<option value="vertical_bottom">Bottom</option>
											<option value="vertical_center">Center</option>
										</select>
									</td>
								</tr>
							</table>
						</div>
						<!-- Headers & Footers Content -->
						<div class="tab-pane" id="nav-headers-footers" role="tabpanel">
							<table border="0" style="width:100%">
								<tr>
									<td class="p-3">
										<label for="top-left-${wid}-${tid}" class="form-label">Top Left</label>
										<input type="text" class="form-control" id="top-left-${wid}-${tid}">
									</td>
									<td class="p-3">
										<label for="top-middle-${wid}-${tid}" class="form-label">Top Middle</label>
										<input type="text" class="form-control" id="top-middle-${wid}-${tid}">
									</td>
									<td class="p-3">
										<label for="top-right-${wid}-${tid}" class="form-label">Top Right</label>
										<input type="text" class="form-control" id="top-right-${wid}-${tid}">
									</td>
								</tr>
								<tr>
									<td class="p-3">
										<label for="bottom-left-${wid}-${tid}" class="form-label">Bottom Left</label>
										<input type="text" class="form-control" id="bottom-left-${wid}-${tid}">
									</td>
									<td class="p-3">
										<label for="bottom-middle-${wid}-${tid}" class="form-label">Bottom Middle</label>
										<input type="text" class="form-control" id="bottom-middle-${wid}-${tid}">
									</td>
									<td class="p-3">
										<label for="bottom-right-${wid}-${tid}" class="form-label">Bottom Right</label>
										<input type="text" class="form-control" id="bottom-right-${wid}-${tid}">
									</td>
								</tr>
								<tr>
									<td class="p-3">
										<div class="form-check">
											<input class="form-check-input" type="checkbox" id="frozen-rows-${wid}-${tid}">
											<label class="form-check-label" for="frozen-rows-${wid}-${tid}">
												Repeat frozen rows
											</label>
										</div>
										<div class="form-check">
											<input class="form-check-input" type="checkbox" id="frozen-columns-${wid}-${tid}">
											<label class="form-check-label" for="frozen-columns-${wid}-${tid}">
												Repeat frozen columns
											</label>
										</div>
									</td>
								</tr>
							</table>
						</div>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-outline-secondary restore-${wid}-${tid}">Restore</button>
				<button type="submit" class="btn btn-primary done-${wid}-${tid}">Done</button>
			</div>
		</div>
	</div>
</div>`);

		$(`#tasks-point-${wid}`).append(html_task);
		if (!task) $(`#task-modal-${wid}-${tid}`).modal("show");

		// Initially disabled margin and page sizes value
		$(`#margins-top-${wid}-${tid}, #margins-left-${wid}-${tid}, #margins-right-${wid}-${tid}, #margins-bottom-${wid}-${tid}, 
        #size-height-${wid}-${tid},#size-width-${wid}-${tid} `).prop('disabled', true);

		// Hide range, break row at, break column and custom text box
		$(`.range-span, #print-range-${wid}-${tid}, .break-span, #break-column-${wid}-${tid}, #break-row-${wid}-${tid}, .custom-span, #percentage-${wid}-${tid}`).hide();

		// Initial style for print and scale select tag
		$(`#print-${wid}-${tid}, #scale-${wid}-${tid}`).css("border-radius", ".375rem")

		$(`#size-${wid}-${tid}`)
			.on("change", function() {
				var height = $(this)
					.children('option:selected')
					.data('height')
				var width = $(this)
					.children('option:selected')
					.data('width')
				if (height == "" && width == "") {
					$(`#size-height-${wid}-${tid}`)
						.prop('disabled', false)
					$(`#size-width-${wid}-${tid}`)
						.prop('disabled', false)
				} else {
					$(`#size-height-${wid}-${tid}`)
						.prop('disabled', true)
					$(`#size-width-${wid}-${tid}`)
						.prop('disabled', true)
				}
				$(`#size-width-${wid}-${tid}`)
					.val(width);
				$(`#size-height-${wid}-${tid}`)
					.val(height);
			})

		$(`#margins-${wid}-${tid}`)
			.on("change", function() {
				var top = $(`#margins-top-${wid}-${tid}`)
					.val($(this)
						.children('option:selected')
						.data('top'))

				var left = $(`#margins-left-${wid}-${tid}`)
					.val($(this)
						.children('option:selected')
						.data('left'))

				var right = $(`#margins-right-${wid}-${tid}`)
					.val($(this)
						.children('option:selected')
						.data('right'))

				var bottom = $(`#margins-bottom-${wid}-${tid}`)
					.val($(this)
						.children('option:selected')
						.data('bottom'))

				if (top.val() == "" && left.val() == "" && bottom.val() == "" && right.val() == "") {
					$(`#margins-top-${wid}-${tid}`)
						.prop('disabled', false)
					$(`#margins-left-${wid}-${tid}`)
						.prop('disabled', false)
					$(`#margins-right-${wid}-${tid}`)
						.prop('disabled', false)
					$(`#margins-bottom-${wid}-${tid}`)
						.prop('disabled', false)
				} else {
					$(`#margins-top-${wid}-${tid}`)
						.prop('disabled', true)
					$(`#margins-left-${wid}-${tid}`)
						.prop('disabled', true)
					$(`#margins-right-${wid}-${tid}`)
						.prop('disabled', true)
					$(`#margins-bottom-${wid}-${tid}`)
						.prop('disabled', true)
				}
				$(`#margins-top-${wid}-${tid}`).val(top.val())
				$(`#margins-left-${wid}-${tid}`).val(top.val())
				$(`#margins-right-${wid}-${tid}`).val(top.val())
				$(`#margins-bottom-${wid}-${tid}`).val(top.val())
			})

		$(`#print-${wid}-${tid}`)
			.on("change", function() {
				var value = $(this)
					.children('option:selected').text();
				if (value.indexOf('Selected range of ') == 0) {
					$(`.range-span, #print-range-${wid}-${tid}`).show()
					$(`#print-${wid}-${tid}`).css({
						"border-top-right-radius": "0",
						"border-bottom-right-radius": "0"
					});
				} else {
					$(`.range-span, #print-range-${wid}-${tid}`).hide();
					$(`#print-${wid}-${tid}`).css("border-radius", ".375rem");
				}
			})

		$(`#scale-${wid}-${tid}`)
			.on("change", function() {
				var value = $(this)
					.children('option:selected').val();
				if (value == "fittipagebreaks") {
					$(`.break-span, #break-column-${wid}-${tid}, #break-row-${wid}-${tid}`).show();
					$(`#scale-${wid}-${tid}`).css({
						"border-top-right-radius": "0",
						"border-bottom-right-radius": "0"
					});
				} else {
					$(`.break-span, #break-column-${wid}-${tid}, #break-row-${wid}-${tid}`).hide();
					$(`#scale-${wid}-${tid}`).css("border-radius", ".375rem");
				}
				if (value == "custom") {
					$(`.custom-span, #percentage-${wid}-${tid}`).show();
					$(`#scale-${wid}-${tid}`).css({
						"border-top-right-radius": "0",
						"border-bottom-right-radius": "0"
					});
					$(`#percentage-${wid}-${tid}`).css({
						"border-top-right-radius": ".375rem",
						"border-bottom-right-radius": ".375rem"
					});
				} else {
					$(`.custom-span, #percentage-${wid}-${tid}`).hide();
				}
			})

		$(`.restore-${wid}-${tid}`).on('click', function(e) {
                // if (!task) return;
				var data = ["Sheet1", "Sheet2", "Sheet3", "Sheet4"];
				for (var index = 0; index < data.length; index++) {
					$(`#print-${wid}-${tid}`).append(`<option value="${data[index]}">${data[index]}</option>`);
					$(`#print-${wid}-${tid}`).append(`<option value="${data[index]}">Selected range of ${data[index]}</option>`);
		}

			}).click();

		$(`.done-${wid}-${tid}`).on('click', function(e) {
			e.preventDefault()
			e.stopPropagation()
			console.log(getPDFFileValues(wid, tid));
			$(`#task-modal-${wid}-${tid}`).modal('hide');
		})


	}

	

	// Delete Instance
	$(`.tdelete`).on('click', function(e) {
		$(this).parent().parent().parent().parent().remove();
	})

	$("#pdfprint").click(function(event) {
		createTask_PDFFile("l9zgqjql")
	});

	$("#restoreall").click(function(event) {
		$("#tasks-point-l9zgqjql").html('')
		var wflw = {
			id: "l9zgqjql",

			tasks: [{
					"taskType": "pdfprint",
					"id": "ey1lue4g",

					"name": "ey1lue4g",
					"method": "POST",
					"url": {
						"raw": "https://beautifier.io/",
						"protocol": "https",
						"host": ["beautifier", "io"],
						"path": [],
						"query": [{
							"key": "param1",
							"value": "value1"
						}, {
							"key": "param2",
							"value": "value2"
						}]
					},
					"auth": {
						"type": "apikey",
						"apikey": [{
							"key": "key",
							"value": "x-apikey",
							"type": "string"
						}, {
							"key": "value",
							"value": "x-value",
							"type": "string"
						}, {
							"key": "in",
							"value": "queryparams",
							"type": "string"
						}]
					},
					"header": [{
						"key": "hkey1",
						"value": "hvalue1",
						"type": "text"
					}, {
						"key": "hkey2",
						"value": "",
						"type": "text"
					}, {
						"key": "hkey3",
						"value": "hvalue3",
						"type": "text"
					}],
					"body": {
						"mode": "raw",
						"raw": "\"{\\n\\\"bodykey\\\":\\\"bodyvalue\\\"\\n}\"",
						"options": {
							"raw": {
								"language": "json"
							}
						}
					},
					"response": []
				},
				{
					"taskType": "pdfprint",
					"id": "fx1hwe8q",

					"name": "fx1hwe8q",
					"method": "PATCH",
					"url": {
						"raw": "https://www.upwork.com/",
						"protocol": "https",
						"host": [
							"beautifier",
							"io"
						],
						"path": [],
						"query": [{
								"key": "iparam1",
								"value": "ivalue1"
							},
							{
								"key": "iparam2",
								"value": "ivalue2"
							}
						]
					},
					"auth": {
						"type": "bearertoken",
						"bearer": [{
							"key": "token",
							"value": "xxxxx.yyyyy.zzzzz",
							"type": "string"
						}]
					},
					"header": [{
							"key": "ikey1",
							"value": "ivalue1",
							"type": "text"
						},
						{
							"key": "ikey2",
							"value": "",
							"type": "text"
						},
						{
							"key": "ikey3",
							"value": "ivalue3",
							"type": "text"
						}
					],
					"body": {
						"mode": "raw",
						"raw": "\"This is a plain text\"",
						"options": {
							"raw": {
								"language": "text"
							}
						}
					},
					"response": []
				}
			]

		}
		wflw.tasks.forEach(t => {
			if (t.taskType == "pdfprint") {
				t = JSON.parse(prompt("Please override instance if you need", JSON.stringify(t)));
				createTask_PDFFile(wflw.id, t, "pdfprint")
			}
		})
	});

	$(`#sendall`).click(function(e) {
		r = [];
		error = false;
		$(`#tasks-point-l9zgqjql`).children().each(function() {
			if ($(this).data("type") == "pdfprint") {
				var ids = $(this).data("id").split("-");
				var w = getPDFFileValues(ids[0], ids[1])
				if (!w) {
					$(`#task-modal-${$(this).data("id")}`).modal("show");
					error = true;
					return false;
				} else
					r.push(w);
			}
		});
		if (!error)
			console.log(JSON.stringify(r, null, 4))

	});
	</script>
</body>

</html>
