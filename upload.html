
  <div class="container mt-5">
    <!-- TAB CONTENT -->
    <div class="tab-content mt-5">
      <!-- page setup Content -->
      <table border="0" style="width:100%">
        <tr>
          <td style="width:50%">
            <label for="print" class="form-label">Print</label>
            <div class="input-group">
              <select class="form-select" id="print">
                <option selected value="currentsheet">Current sheet</option>
                <option value="workbook">Workbook</option>
                <option value="selectedcells">Selected cells(A1)</option>
              </select>
              <span class="input-group-text" id="range">Range</span>
              <input type="text" class="form-control" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-default">
            </div>
          </td>
        </tr>
        <tr>
          <td style="width:50%">
            <label for="paper-size" class="form-label">Paper size</label>
            <div class="input-group">
              <select class="form-select" id="paper-size">
                <option selected value="currentsheet">Letter (8.5" * 11")</option>
                <option value="currentsheet">Tabloid (11" * 17")</option>
                <option value="currentsheet">Legal (8.5" * 14")</option>
                <option value="currentsheet">Statement (5.5" * 8.5")</option>
                <option value="currentsheet">Executive (7.25" * 10.5")</option>
                <option value="currentsheet">Folio (8.5" * 13")</option>
                <option value="currentsheet">A3 (11.69" * 16.54")</option>
                <option value="currentsheet">A4 (8.27" * 11.69")</option>
                <option value="currentsheet">A5 (5.83" * 8.27")</option>
                <option value="currentsheet">B4 (9.84" * 13.90")</option>
                <option value="currentsheet">B5 (6.93" * 9.84")</option>
                <option value="custom">Custom</option>
              </select>
              <span class="input-group-text" id="inputGroup-sizing-default">Height</span>
              <input type="number" class="form-control" value="5.55" step="0.5">
              <span class="input-group-text" id="inputGroup-sizing-default">Width</span>
              <input type="number" class="form-control" value="9.99" step="0.5">
            </div>
          </td>
        </tr>
        <tr>
          <td style="width:50%">
            <label for="margin" class="form-label">Margins</label>
            <div class="input-group">
              <select class="form-select" id="margin">
                <option selected value="currentsheet">Normal</option>
                <option value="workbook">Narrow</option>
                <option value="selectedcells">Wide</option>
                <option value="custom">Custom</option>
              </select>
              <span class="input-group-text" id="basic-addon3">Top</span>
              <input type="number" class="form-control" value="0.1" id="basic-url" aria-describedby="basic-addon3">
              <span class="input-group-text" id="basic-addon3">Left</span>
              <input type="number" class="form-control" value="1.1" id="basic-url" aria-describedby="basic-addon3">
              <span class="input-group-text" id="basic-addon3">Right</span>
              <input type="number" class="form-control" value="2.2" id="basic-url" aria-describedby="basic-addon3">
              <span class="input-group-text" id="basic-addon3">Bottom</span>
              <input type="number" class="form-control" value="3.3" id="basic-url" aria-describedby="basic-addon3">
            </div>
          </td>
        </tr>
        <tr>
          <td style="width:50%">
            <label for="scale" class="form-label">Scale</label>
            <div class="input-group">
              <select class="form-select" id="scale">
                <option selected value="normal">Normal (100%)</option>
                <option value="fittowidth">Fit to width</option>
                <option value="fittoheight">Fit to height</option>
                <option value="fittopage">Fit to page</option>
                <option value="custom">Custom</option>
                <option value="fittipagebreaks">Fit to pagebreaks (100%)</option>
              </select>
              <span class="input-group-text" id="basic-addon3">Break row at</span>
              <input type="number" class="form-control" value="20" id="basic-url" aria-describedby="basic-addon3">
              <span class="input-group-text" id="basic-addon3">Break column at</span>
              <input type="number" class="form-control" value="5" id="basic-url" aria-describedby="basic-addon3">
            </div>
          </td>
        </tr>
        <tr>
          <td style="width:50%">
            <div class="form-check">
              <input class="form-check-input" type="radio" name="flexRadioDefault" id="flexRadioDefault1">
              <label class="form-check-label" for="flexRadioDefault1"> Default radio </label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="flexRadioDefault" id="flexRadioDefault2" checked>
              <label class="form-check-label" for="flexRadioDefault2"> Default checked radio </label>
            </div>
          </td>
        </tr>
        <tr>
          <td style="width:50%">
            <div class="input-group">
            </div>
          </td>
        </tr>
      </table>
    </div>
  </div>

<!-- 

  <body>
  <button type="button" class="m-3 btn btn-primary" id="webhook">New Webhook</button>
  <button type="button" class="m-3 btn btn-outline-secondary" id="restoreall">Restore All</button>
  <button type="button" class="m-3 btn btn-outline-secondary" id="sendall">Send All</button>
  <hr>
  <ul class="list-group" id="tasks-point-l9zgqjql"></ul>
  <div id="modal"></div>
  <script>
    function atoo(f, b) {
      var c = [],
        d = !1;
      f.forEach(function(g, e) {
        var a = {};
        a.key = g;
        a.value = 0 === b[e].length ? "" : b[e];
        "" === a.key.trim() && "" !== a.value ? d = !0 : "" !== a.key.trim() && c.push(a);
      });
      return d ? !1 : c;
    }

    function isValidUrl(a) {
      try {
        return new URL(a), !0;
      } catch (b) {
        return !1;
      }
    }

    function getAddTaskEnvelope(wid, tid, tasktype, task_body) {
      return `<li class="border-top-0 border-end-0 border-start-0 list-group-item tsk-${wid}-${tid} ${tasktype}" data-id="${wid}-${tid}" data-type="${tasktype}">
                <img src="https://img.icons8.com/color/48/null/webhook.png" class="float-start" />

                <div class="btn-group float-end">
                    <button type="button" class="btn dropdown-toggle btn-light" data-bs-toggle="dropdown" aria-expanded="false"> Actions </button>
                    <ul class="dropdown-menu dropdown-menu-lg-end">
                        <li><a data-bs-toggle="modal" href="#task-modal-${wid}-${tid}" role="button" class="dropdown-item" href="#">Edit</a></li>
                        <li><a class="dropdown-item" href="#">Duplicate</a></li>
                        <li><a class="dropdown-item tdelete" href="#">Delete</a></li>
                    </ul>
                </div>
		${task_body}
            </li>`
    }

    function getWebhookValues(wid, tid) {
      let result = {};
      result.taskType = "webhook";
      result.id = tid;
      result.name = `${wid}-${tid}`;
      let urlInputEle = $(`#url-${wid}-${tid}`);
      let urlVal = urlInputEle.val();
      // URL INPUT VALIDATION
      if (urlVal.length === 0 || !isValidUrl(urlVal)) {
        alert("URL is Required")
        return;
      }
      result.method = $(`#method-${wid}-${tid}`)
        .val()
        .toUpperCase();
      // URL key
      result.url = {};
      result.url.raw = urlVal;
      let urlValues = new URL(urlVal);
      result.url.protocol = urlValues.protocol.replace(':', '');
      result.url.host = urlValues.hostname.split('.');
      result.url.path = urlValues.pathname.split('/')
        .filter((val) => val !== "");
      let dataArr = atoo($(`#nav-qp-${wid}-${tid} .key`)
        .map(function() {
          return this.value;
        })
        .get(), $(`#nav-qp-${wid}-${tid} .value`)
        .map(function() {
          return this.value;
        })
        .get());
      if (dataArr !== false) {
        if (dataArr.length > 0) {
          result.url.query = dataArr;
        }
      } else {
        alert("Key is missing in Params Tab");
        return;
      }
      // AUTHORIZATION
      result.auth = {};
      result.auth.type = $(`#auth-type-${wid}-${tid}`)
        .val();
      if (result.auth.type === "apikey") {
        let key = $(`#apiKeyInput-${wid}-${tid}`)
          .val();
        let value = $(`#apikey-value-${wid}-${tid}`)
          .val();
        if ((key.trim() === "" && value !== "") || (key.trim() === "" && value.trim() === "")) {
          alert("API Key is missing in Authorization tab");
          return;
        }
        result.auth.apikey = [{
            "key": "key",
            "value": key,
            "type": "string"
          },
          {
            "key": "value",
            "value": value,
            "type": "string"
          },
          {
            "key": "in",
            "value": $('input[name=addToRadioOptions]:checked', `.authtab-${wid}-${tid}`)
              .val(),
            "type": "string"
          }
        ];
      } else if (result.auth.type === "bearertoken") {
        let bearerTokenValue = $(`#bearer-value-${wid}-${tid}`)
          .val();
        if (bearerTokenValue.trim() === "") {
          alert("Bearer token is missing in Authorization tab");
          return;
        }
        result.auth.bearer = [{
          "key": "token",
          "value": `${bearerTokenValue}`,
          "type": "string"
        }]
      } else if (result.auth.type === "basic") {
        let uNameValue = $(`#basic-username-${wid}-${tid}`)
          .val();
        let passwordValue = $(`#basic-password-${wid}-${tid}`)
          .val();

        if (uNameValue.trim() === '' || passwordValue.trim() === '') {
          alert("Username and Password must not be empty in the Authorization Tab");
          return;
        }

        result.auth.basic = [{
          "key": "username",
          "value": `${uNameValue}`,
          "type": "string"
        }, {
          "key": "password",
          "value": `${passwordValue}`,
          "type": "string"
        }]
      } else if (result.auth.type === "oauth2") {
        let oauthTokenValue = $(`#oauth-value-${wid}-${tid}`)
          .val();
        if (oauthTokenValue.trim() === "") {
          alert("OAuth token is missing in Authorization tab");
          return;
        }
        result.auth.oauth2 = [{
          "key": "token",
          "value": `${oauthTokenValue}`,
          "type": "string"
        }, {
          "key": "addTokenTo",
          "value": "header",
          "type": "string"
        }]
      }
      // HEADER 
      let headerData = atoo($(`#nav-headers-${wid}-${tid} .key`)
        .map(function() {
          return this.value;
        })
        .get(), $(`#nav-headers-${wid}-${tid} .value`)
        .map(function() {
          return this.value;
        })
        .get())
      if (headerData !== false) {
        result.header = headerData;
        result.header.forEach((res) => {
          res.type = "text";
        })
      } else {
        alert("Key is missing in Headers Tab");
        return;
      }

      // BODY
      let bodyContentType = $(`#body-content-type-${wid}-${tid}`).val();
      if (bodyContentType === "appurlencoded") {
        result.body = {};
        result.body.mode = "urlencoded";
        let bodyTabUrlArr = atoo($(`.urlencodedtab-${wid}-${tid} .key`)
          .map(function() {
            return this.value;
          })
          .get(), $(`.urlencodedtab-${wid}-${tid} .value`)
          .map(function() {
            return this.value;
          })
          .get())

        if (bodyTabUrlArr !== false) {
          if (bodyTabUrlArr.length === 0) {
            alert("Key and Value is Missing");
            return;
          }
          result.body.urlencoded = bodyTabUrlArr;
          result.body.urlencoded.forEach((res) => {
            res.type = "text";
          })
        } else {
          alert("Key is missing in Body Tab");
          return;
        }

      } else if (bodyContentType === "appjson") {
        if ($(`#use-raw-${wid}-${tid}`)
          .prop('checked')) {
          result.body = {};
          result.body.mode = "raw";
          result.body.raw = JSON.stringify($(`#json-value-${wid}-${tid}`)
            .val());
          if (result.body.raw.length <= 2) {
            alert("Result body should not be empty in Body tab");
            return;
          }
          result.body.options = {
            "raw": {
              "language": "json"
            }
          }
        } else {
          result.body = {};
          result.body.mode = "formdata";
          var bodyTabFormDataArr = atoo($(`.jsontab-${wid}-${tid} .key`)
            .map(function() {
              return this.value;
            })
            .get(), $(`.jsontab-${wid}-${tid} .value`)
            .map(function() {
              return this.value;
            })
            .get())

          if (bodyTabFormDataArr !== false) {
            if (bodyTabFormDataArr.length === 0) {
              alert("Key and Value is Missing");
              return;
            }
            result.body.formdata = bodyTabFormDataArr;
            result.body.formdata.forEach((res) => {
              res.type = "text";
            })
          } else {
            alert("Key is missing in Body Tab");
            return;
          }

        }
      } else if (bodyContentType === "textplain") {
        result.body = {};
        result.body.mode = "raw";
        result.body.raw = JSON.stringify($(`#text-value-${wid}-${tid}`)
          .val());
        if (result.body.raw.length <= 2) {
          alert("Result body should not be empty in Body tab");
          return;
        }
        result.body.options = {
          "raw": {
            "language": "text"
          }
        }
      } else if (bodyContentType === "texthtml") {
        result.body = {};
        result.body.mode = "raw";
        result.body.raw = JSON.stringify($(`#html-value-${wid}-${tid}`)
          .val());
        if (result.body.raw.length <= 2) {
          alert("Result body should not be empty in Body tab");
          return;
        }
        result.body.options = {
          "raw": {
            "language": "html"
          }
        }
      } else if (bodyContentType === "appxml") {
        result.body = {};
        result.body.mode = "raw";
        result.body.raw = JSON.stringify($(`#xml-value-${wid}-${tid}`)
          .val());
        if (result.body.raw.length <= 2) {
          alert("Result body should not be empty in Body tab");
          return;
        }
        result.body.options = {
          "raw": {
            "language": "xml"
          }
        }
      } else if (bodyContentType === "appjavascript") {
        result.body = {};
        result.body.mode = "raw";
        result.body.raw = JSON.stringify($(`#js-value-${wid}-${tid}`)
          .val());
        if (result.body.raw.length <= 2) {
          alert("Result body should not be empty in Body tab");
          return;
        }
        result.body.options = {
          "raw": {
            "language": "javascript"
          }
        }
      }
      // Response
      result.response = []
      return result;

    }

    function createTask_Webhook(wid, task) {
      var tid = task?.id ? task.id : Math.random().toString(36).substr(2, 8);
      var html_task = getAddTaskEnvelope(wid, tid, "webhook", `<div class="ms-5 ps-3">
		<span class="task-title">Webhook: ${wid}-${tid} </span><br>
		<span class="text-secondary small">Last updated </span><span class="time text-secondary small" data-time="1667889127596">15 days ago</span>
	</div>

	<div class="modal fade" id="task-modal-${wid}-${tid}" aria-hidden="true" aria-labelledby="task-modal-label-${wid}-${tid}" tabindex="-1">
		<div class="modal-dialog modal-fullscreen">
			<div class="modal-content">
				<div class="modal-header border border-bottom-0 bg-theme">
					<img style="width:25px;" src="https://img.icons8.com/color/48/null/webhook.png" class="float-start">&nbsp;
					<span class="modal-title fw-bolder ms-1 ps-0" id="task-modal-label-${wid}-${tid}">Create Webhook Instance</span>
					<button type="button" class="me-1 btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body border">
					<!--Modal body goes here.-->
					<!--form id="form-${wid}-${tid}" class="needs-validation" novalidate-->
          <div class="container mt-5">
            <!-- Top Dropdown -->
            <!-- <div class="row d-flex flex-row justify-content-between mb-3">
              <div class="col-5 col-sm-3">
                <label for="method-${wid}-${tid}" class="form-label">Method</label>
                <select class="form-select" id="method-${wid}-${tid}">
                  <option selected value="get">GET</option>
                  <option value="post">POST</option>
                  <option value="put">PUT</option>
                  <option value="patch">PATCH</option>
                  <option value="delete">DELETE</option>
                </select>
              </div>
              <div class="col-7 col-sm-9">
                <label for="url-${wid}-${tid}" class="form-label">Request URL</label>
                <div class="d-flex input-group">
                  <input type="url" id="url-${wid}-${tid}" class="form-control" required />
                  <button type="button" class="btn btn-outline-primary" id="send-${wid}-${tid}">Send</button>
                </div>

              </div>
            </div> -->
            <!-- TAB -->
            <nav class="mt-5">
          <div class="nav nav-tabs" role="tablist">
              <button type="button" class="nav-link active" data-bs-toggle="tab" data-bs-target="#nav-page-setup"
                  role="tab" aria-selected="true"> Page Setup <span class="ms-1 d-inline-block rounded-circle"></span>
              </button>
              <button type="button" class="nav-link" data-bs-toggle="tab" data-bs-target="#nav-formating" role="tab"
                  aria-selected="false"> Formatting </button>
              <button type="button" class="nav-link" data-bs-toggle="tab" data-bs-target="#nav-headers-footers"
                  role="tab" aria-selected="false"> Headers & Footers <span
                      class="ms-1 d-inline-block rounded-circle"></span>
              </button>
          </div>
      </nav>
      <!-- TAB CONTENT -->
      <div class="tab-content mt-5">
          <!-- page setup Content -->
          <div class="tab-pane fade show active" id="nav-page-setup" role="tabpanel">
              <div class="row">
                  <div class="col-6">
                      <div class="row print-row">
                          <div class="col-12">
                              <label for="print" class="form-label">Print</label>
                              <select class="form-select" id="print">
                                  <option selected value="currentsheet">Current sheet</option>
                                  <option value="workbook">Workbook</option>
                                  <option value="selectedcells">Selected cells(A1)</option>
                              </select>
                          </div>
                          <div class="col-6 selected-cells">
                              <div class="d-flex align-items-end">
                                  <div class="input-group">
                                      <span class="input-group-text" id="inputGroup-sizing-default">Range</span>
                                      <input type="text" class="form-control" aria-label="Sizing example input"
                                          aria-describedby="inputGroup-sizing-default">
                                  </div>
                              </div>
                          </div>
                      </div>
                  </div>
                  <div class="col-6">
                      <div class="row paper-size-row">
                          <div class="col-12">
                              <label for="paper-size" class="form-label">Paper size</label>
                              <select class="form-select" id="paper-size">
                                  <option selected value="currentsheet">Letter (8.5" * 11")</option>
                                  <option value="currentsheet">Tabloid (11" * 17")</option>
                                  <option value="currentsheet">Legal (8.5" * 14")</option>
                                  <option value="currentsheet">Statement (5.5" * 8.5")</option>
                                  <option value="currentsheet">Executive (7.25" * 10.5")</option>
                                  <option value="currentsheet">Folio (8.5" * 13")</option>
                                  <option value="currentsheet">A3 (11.69" * 16.54")</option>
                                  <option value="currentsheet">A4 (8.27" * 11.69")</option>
                                  <option value="currentsheet">A5 (5.83" * 8.27")</option>
                                  <option value="currentsheet">B4 (9.84" * 13.90")</option>
                                  <option value="currentsheet">B5 (6.93" * 9.84")</option>
                                  <option value="custom">Custom</option>
                              </select>
                          </div>
                          <div class="col-8 d-flex align-items-end">
                              <div class="row custom-paper-size">
                                  <div class=col-6>
                                      <div class="input-group">
                                          <span class="input-group-text"
                                              id="inputGroup-sizing-default">Height</span>
                                          <input type="number" class="form-control" value="5.55" step="0.5">
                                      </div>
                                  </div>
                                  <div class=col-6>
                                      <div class="input-group">
                                          <span class="input-group-text"
                                              id="inputGroup-sizing-default">Width</span>
                                          <input type="number" class="form-control" value="9.99" step="0.5">
                                      </div>
                                  </div>
                              </div>
                          </div>
                      </div>
                  </div>
              </div>
              <!-- 2nd row -->
              <div class="row mt-3 margin">
                  <div class="col-12">
                      <label for="margin" class="form-label">Margins</label>
                      <select class="form-select" id="margin">
                          <option selected value="currentsheet">Normal</option>
                          <option value="workbook">Narrow</option>
                          <option value="selectedcells">Wide</option>
                          <option value="custom">Custom</option>
                      </select>
                  </div>
                  <div class="col-9 d-flex align-items-end ">
                      <div class="row custom-margin">
                          <div class="col-3">
                              <div class="input-group">
                                  <span class="input-group-text" id="basic-addon3">Top</span>
                                  <input type="number" class="form-control" value="0.1" id="basic-url"
                                      aria-describedby="basic-addon3">
                              </div>
                          </div>
                          <div class="col-3">
                              <div class="input-group">
                                  <span class="input-group-text" id="basic-addon3">Left</span>
                                  <input type="number" class="form-control" value="1.1" id="basic-url"
                                      aria-describedby="basic-addon3">
                              </div>
                          </div>
                          <div class="col-3">
                              <div class="input-group">
                                  <span class="input-group-text" id="basic-addon3">Right</span>
                                  <input type="number" class="form-control" value="2.2" id="basic-url"
                                      aria-describedby="basic-addon3">
                              </div>
                          </div>
                          <div class="col-3">
                              <div class="input-group">
                                  <span class="input-group-text" id="basic-addon3">Bottom</span>
                                  <input type="number" class="form-control" value="3.3" id="basic-url"
                                      aria-describedby="basic-addon3">
                              </div>
                          </div>
                      </div>
                  </div>
              </div>
              <!-- 3rd row -->
              <div class="row mt-3 scale">
                  <div class="col-12">
                      <label for="scale" class="form-label">Scale</label>
                      <select class="form-select" id="scale">
                          <option selected value="normal">Normal (100%)</option>
                          <option value="fittowidth">Fit to width</option>
                          <option value="fittoheight">Fit to height</option>
                          <option value="fittopage">Fit to page</option>
                          <option value="custom">Custom</option>
                          <option value="fittipagebreaks">Fit to pagebreaks (100%)</option>
                      </select>
                  </div>
                  <div class="col-8 d-flex align-items-end ">
                      <div class="row fit-to-pagebreaks-input-groups">
                          <div class="col-6">
                              <div class="input-group">
                                  <span class="input-group-text" id="basic-addon3">Break row at</span>
                                  <input type="number" class="form-control" value="20" id="basic-url"
                                      aria-describedby="basic-addon3">
                              </div>
                          </div>
                          <div class="col-6">
                              <div class="input-group">
                                  <span class="input-group-text" id="basic-addon3">Break column at</span>
                                  <input type="number" class="form-control" value="5" id="basic-url"
                                      aria-describedby="basic-addon3">
                              </div>
                          </div>
                      </div>
                  </div>
              </div>
              <!-- 4th row -->
              <div class="row mt-3">
                  <div class="col-6">
                      <label class="form-label d-block">Page Orientation</label>
                      <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" name="inlineRadioOptions" id="landscape"
                              checked>
                          <label class="form-check-label" for="landscape">Landscape</label>
                      </div>
                      <div class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" name="inlineRadioOptions" id="portait">
                          <label class="form-check-label" for="portait">Portait</label>
                      </div>
                  </div>
              </div>
          </div>
          <!-- Formating Content -->
          <div class="tab-pane fade" id="nav-formating" role="tabpanel">
              <div class="row">
                  <div class="col-6">
                      <label for="page-order" class="form-label">Page order</label>
                      <select class="form-select" id="page-order">
                          <option selected value="currentsheet">Over, then down</option>
                          <option value="currentsheet">Down, then over</option>
                      </select>
                  </div>
                  <div class="col-6">
                      <label for="horizontal" class="form-label">Horizontal Alignment</label>
                      <select class="form-select" id="horizontal">
                          <option selected value="currentsheet">Center</option>
                          <option value="currentsheet">Left</option>
                          <option value="currentsheet">Right</option>
                      </select>
                  </div>
              </div>
              <div class="row mt-3">
                  <div class="col-6 d-flex flex-column justify-content-end">
                      <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="showgridlines">
                          <label class="form-check-label" for="flexCheckDefault">
                              Show gridlines
                          </label>
                      </div>
                      <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="shownotes">
                          <label class="form-check-label" for="flexCheckDefault">
                              Show notes
                          </label>
                      </div>
                  </div>
                  <div class="col-6">
                      <label for="vertical" class="form-label">Vertical Alignment</label>
                      <select class="form-select" id="vertical">
                          <option selected value="currentsheet">Top</option>
                          <option value="currentsheet">Bottom</option>
                          <option value="currentsheet">Center</option>
                      </select>
                  </div>
              </div>
          </div>
          <!-- Headers & Footers Content -->
          <div class="tab-pane fade" id="nav-headers-footers" role="tabpanel">
              <div class="row">
                  <div class=col-4>
                      <div class="mb-3">
                          <label for="top-left" class="form-label">Top Left</label>
                          <input type="text" class="form-control" id="top-left">
                      </div>
                  </div>
                  <div class=col-4>
                      <div class="mb-3">
                          <label for="top-middle" class="form-label">Top Middle</label>
                          <input type="text" class="form-control" id="top-middle">
                      </div>
                  </div>
                  <div class=col-4>
                      <div class="mb-3">
                          <label for="top-right" class="form-label">Top Right</label>
                          <input type="text" class="form-control" id="top-right">
                      </div>
                  </div>
              </div>
              <div class="row">
                  <div class=col-4>
                      <div class="mb-3">
                          <label for="bottom-left" class="form-label">Bottom Left</label>
                          <input type="text" class="form-control" id="bottom-left">
                      </div>
                  </div>
                  <div class=col-4>
                      <div class="mb-3">
                          <label for="bottom-middle" class="form-label">Bottom Middle</label>
                          <input type="text" class="form-control" id="bottom-middle">
                      </div>
                  </div>
                  <div class=col-4>
                      <div class="mb-3">
                          <label for="bottom-right" class="form-label">Bottom Right</label>
                          <input type="text" class="form-control" id="bottom-right">
                      </div>
                  </div>
              </div>

              <div class="row">
                  <div class="col-4">
                      <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="page-numbers">
                          <label class="form-check-label" for="page-numbers">
                              Page Numbers
                          </label>
                      </div>
                      <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="workbook-title">
                          <label class="form-check-label" for="workbook-title">
                              Workbook title
                          </label>
                      </div>
                      <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="sheet-name">
                          <label class="form-check-label" for="sheet-name">
                              Sheet name
                          </label>
                      </div>
                  </div>
                  <div class="col-4">
                      <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="current-date">
                          <label class="form-check-label" for="current-date">
                              Current Date
                          </label>
                      </div>
                      <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="current-time">
                          <label class="form-check-label" for="current-time">
                              Current Time
                          </label>
                      </div>
                  </div>
                  <div class="col-4">
                      <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="frozen-rows">
                          <label class="form-check-label" for="frozen-rows">
                              Repeat frozen rows
                          </label>
                      </div>
                      <div class="form-check">
                          <input class="form-check-input" type="checkbox" id="frozen-columns">
                          <label class="form-check-label" for="frozen-columns">
                              Repeat frozen columns
                          </label>
                      </div>
                  </div>
              </div>

          </div>
      </div>

          </div>
        <!--/form-->
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-secondary restore-${wid}-${tid}">Restore</button>
        <button type="submit" class="btn btn-primary done-${wid}-${tid}">Done</button>
      </div>
    </div>
  </div>
</div>`);

    $(`#tasks-point-${wid}`).append(html_task);
    if(!task) $(`#task-modal-${wid}-${tid}`).modal("show");

    $(`.custom-page-input-container, .fit-to-pagebreaks-input-groups, .custom-paper-size, .custom-margin, .custom-scale, .selected-cells`).hide();
      // check page setup custom check box
      $(`#set-custom-page`).change(function () {
          if ($(`#set-custom-page`).prop(`checked`)) {
              $(`.custom-page-input-container`).show();
          } else {
              $(`.custom-page-input-container`).hide();
          }
      })

      // Fit to pagebreaks 100%
      $(`#scale`).change(function () {
          let selectedValue = $(this).children("option:selected").val();
          if (selectedValue === "fittipagebreaks") {
              $(".scale > div").removeClass("col-12");
              $(".scale > div").addClass("col-4");
              $(`.fit-to-pagebreaks-input-groups`).show();
          } else {
              $(".scale > div").addClass("col-12");
              $(".scale > div").removeClass("col-4");
              $(`.fit-to-pagebreaks-input-groups`).hide();
          }
      });

      // Custom margin
      $(`#margin`).change(function () {
          let selectedValue = $(this).children("option:selected").val();
          if (selectedValue === "custom") {
              $(".margin > div").removeClass("col-12");
              $(".margin > div").addClass("col-3");
              $(`.custom-margin`).show();
          } else {
              $(".margin > div").addClass("col-12");
              $(".margin > div").removeClass("col-3");
              $(`.custom-margin`).hide();
          }
      });

      // Custom Paper size
      $(`#paper-size`).change(function () {
          let selectedValue = $(this).children("option:selected").val();
          if (selectedValue === "custom") {
              $(".paper-size-row > div").removeClass("col-12");
              $(".paper-size-row > div").addClass("col-4");
              $(`.custom-paper-size`).show();
          } else {
              $(".paper-size-row > div").removeClass("col-4");
              $(".paper-size-row > div").addClass("col-12");
              $(`.custom-paper-size`).hide();
          }
      });

      // Selected print
      $(`#print`).change(function () {
          let selectedValue = $(this).children("option:selected").val();
          if (selectedValue === "selectedcells") {
              $(".print-row > div").removeClass("col-12");
              $(".print-row > div").addClass("col-6");
              $(`.selected-cells`).addClass("d-flex align-items-end")
              $(`.selected-cells`).show();
          } else {
              $(".print-row > div").addClass("col-12");
              $(".print-row > div").removeClass("col-6");
              $(`.selected-cells`).removeClass("d-flex align-items-end")
              $(`.selected-cells`).hide();
          }
      });

    

    $(`.done-${wid}-${tid}`).on('click', function(e) {
      e.preventDefault()
      e.stopPropagation()
      console.log(getWebhookValues(wid, tid));
      $(`#task-modal-${wid}-${tid}`).modal('hide');
    })


  }

  // Delete Instance
  $(`.tdelete`).on('click', function(e) {
    $(this).parent().parent().parent().parent().remove();
  })

  $("#webhook").click(function(event) {
    createTask_Webhook("l9zgqjql")
  });

  $("#restoreall").click(function(event) {
    $("#tasks-point-l9zgqjql").html('')
    var wflw = {
      id: "l9zgqjql",

      tasks: [{
          "taskType": "webhook",
          "id": "ey1lue4g",

          "name": "ey1lue4g",
          "method": "POST",
          "url": {
            "raw": "https://beautifier.io/",
            "protocol": "https",
            "host": ["beautifier", "io"],
            "path": [],
            "query": [{
              "key": "param1",
              "value": "value1"
            }, {
              "key": "param2",
              "value": "value2"
            }]
          },
          "auth": {
            "type": "apikey",
            "apikey": [{
              "key": "key",
              "value": "x-apikey",
              "type": "string"
            }, {
              "key": "value",
              "value": "x-value",
              "type": "string"
            }, {
              "key": "in",
              "value": "queryparams",
              "type": "string"
            }]
          },
          "header": [{
            "key": "hkey1",
            "value": "hvalue1",
            "type": "text"
          }, {
            "key": "hkey2",
            "value": "",
            "type": "text"
          }, {
            "key": "hkey3",
            "value": "hvalue3",
            "type": "text"
          }],
          "body": {
            "mode": "raw",
            "raw": "\"{\\n\\\"bodykey\\\":\\\"bodyvalue\\\"\\n}\"",
            "options": {
              "raw": {
                "language": "json"
              }
            }
          },
          "response": []
        },
        {
          "taskType": "webhook",
          "id": "fx1hwe8q",

          "name": "fx1hwe8q",
          "method": "PATCH",
          "url": {
            "raw": "https://www.upwork.com/",
            "protocol": "https",
            "host": [
              "beautifier",
              "io"
            ],
            "path": [],
            "query": [{
                "key": "iparam1",
                "value": "ivalue1"
              },
              {
                "key": "iparam2",
                "value": "ivalue2"
              }
            ]
          },
          "auth": {
            "type": "bearertoken",
            "bearer": [{
              "key": "token",
              "value": "xxxxx.yyyyy.zzzzz",
              "type": "string"
            }]
          },
          "header": [{
              "key": "ikey1",
              "value": "ivalue1",
              "type": "text"
            },
            {
              "key": "ikey2",
              "value": "",
              "type": "text"
            },
            {
              "key": "ikey3",
              "value": "ivalue3",
              "type": "text"
            }
          ],
          "body": {
            "mode": "raw",
            "raw": "\"This is a plain text\"",
            "options": {
              "raw": {
                "language": "text"
              }
            }
          },
          "response": []
        }
      ]

    }
    wflw.tasks.forEach(t => {
      if (t.taskType == "webhook") {
        t = JSON.parse(prompt("Please override instance if you need", JSON.stringify(t)));
        createTask_Webhook(wflw.id, t, "webhook")
      }
    })
  });

  $(`#sendall`).click(function(e) {
    r = [];
    error = false;
    $(`#tasks-point-l9zgqjql`).children().each(function() {
      if ($(this).data("type") == "webhook") {
        var ids = $(this).data("id").split("-");
        var w = getWebhookValues(ids[0], ids[1])
        if (!w) {
          $(`#task-modal-${$(this).data("id")}`).modal("show");
          error = true;
          return false;
        } else
          r.push(w);
      }
    });
    if (!error)
      console.log(JSON.stringify(r, null, 4))

  });
</script>
</body>
 -->
